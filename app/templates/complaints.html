{% extends "base.html" %}

{% block title %}Оставить жалобу — Yessenov University{% endblock %}
{% block header_title %}Оставить жалобу{% endblock %}
{% block header_desc %}Форма для подачи анонимной жалобы.{% endblock %}

{% block content %}
<form method="post" action="/complaints" class="complaint-form">
<label for="name_surname">Имя и фамилия (необязательно):</label>
<input type="text" id="name_surname" name="name_surname" placeholder="Иван Иванов">
<label for="email">Email (необязательно):</label>
<input type="email" id="email" name="email" placeholder="you@example.com">
<label for="subject">Тема жалобы:</label>
<input type="text" id="subject" name="subject" placeholder="Тема вашей жалобы" required minlength="5" maxlength="100">
<label for="message">Текст жалобы:</label>
<textarea id="message" name="message" rows="5" required placeholder="Опишите вашу жалобу..." minlength="20"></textarea>
<button type="submit" class="btn">Отправить жалобу</button>
</form>
<hr style="margin: 3rem 0; border: none; border-top: 1px solid #ddd;">
<h2>Последние жалобы</h2>
{% if complaints %}
<div class="complaint-list">
{% for complaint in complaints %}
<div class="complaint">
<p class="complaint-meta">{{ complaint.name_surname or "Аноним" }} — {{ complaint.created_at.strftime("%d.%m.%Y") }}</p>
<p class="complaint-subject"><strong>Тема:</strong> {{ complaint.subject }}</p>
<p class="complaint-message">{{ complaint.message }}</p>
{% if complaint.admin_response %}
<p class="complaint-response"><strong>Ответ администрации:</strong> {{ complaint.admin_response }}</p>
{% endif %}
<form method="post" action="/complaints/{{ complaint.id }}/delete" style="margin-top: 0.5rem;">
<button type="submit" class="btn outline danger" onclick="return confirm('Удалить жалобу?');">Удалить</button>
</form>
</div>
{% endfor %}
</div>

<div class="pagination" style="margin-top: 2rem;">
{% if has_prev %}
<a href="?page={{ current_page - 1 }}" class="btn outline">← Назад</a>
{% endif %}
<span style="margin: 0 1rem;">Страница {{ current_page }} из {{ total_pages }}</span>
{% if has_next %}
<a href="?page={{ current_page + 1 }}" class="btn outline">Вперёд →</a>
{% endif %}
</div>
{% else %}
<p>Пока жалоб нет.</p>
{% endif %}
{% endblock %}
